


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > mainPageFrame</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.breachy</a>
</div>

<h1>Coverage Summary for Class: mainPageFrame (org.breachy)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">mainPageFrame</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    83.3%
  </span>
  <span class="absValue">
    (10/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    19.1%
  </span>
  <span class="absValue">
    (13/68)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    47.1%
  </span>
  <span class="absValue">
    (113/240)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package org.breachy;
&nbsp;
&nbsp;import com.fasterxml.jackson.core.JsonProcessingException;
&nbsp;import com.fasterxml.jackson.databind.JsonNode;
&nbsp;import com.fasterxml.jackson.databind.ObjectMapper;
&nbsp;import org.apache.hc.core5.net.URIBuilder;
&nbsp;
&nbsp;import javax.swing.*;
&nbsp;import java.awt.*;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.io.File;
&nbsp;import java.io.IOException;
&nbsp;import java.net.URI;
&nbsp;import java.net.URISyntaxException;
&nbsp;import java.net.http.HttpClient;
&nbsp;import java.net.http.HttpRequest;
&nbsp;import java.net.http.HttpResponse;
&nbsp;import java.util.Scanner;
&nbsp;
&nbsp;public class mainPageFrame extends JFrame implements ActionListener {
<b class="fc">&nbsp;    static ImageIcon breachyLogo = new ImageIcon(mainPageFrame.class.getClassLoader().getResource(&quot;breachyLogo.jpg&quot;));</b>
&nbsp;    private final static String API_Report = &quot;https://www.virustotal.com/vtapi/v2/file/report?&quot;;
&nbsp;    private final static String API_Scan = &quot;https://www.virustotal.com/vtapi/v2/file/scan&quot;;
<b class="fc">&nbsp;    private final static String API_Key = System.getenv(&quot;APIkey&quot;);</b>
&nbsp;    public static File file;
<b class="fc">&nbsp;    public static Scanner input = new Scanner(System.in);</b>
&nbsp;
<b class="fc">&nbsp;    Container mainPageContainer = getContentPane();</b>
<b class="fc">&nbsp;    JLabel searchLabel = new JLabel(&quot;Search&quot;);</b>
<b class="fc">&nbsp;    static JTextField searchField = new JTextField();</b>
<b class="fc">&nbsp;    JButton searchButton = new JButton(&quot;Search&quot;);</b>
<b class="fc">&nbsp;    JCheckBoxMenuItem searchByID = new JCheckBoxMenuItem(&quot;Search By ID&quot;);</b>
<b class="fc">&nbsp;    JCheckBoxMenuItem searchBySystem = new JCheckBoxMenuItem(&quot;Search by System&quot;);</b>
<b class="fc">&nbsp;    JCheckBoxMenuItem searchByVersion = new JCheckBoxMenuItem(&quot;Search By Version&quot;);</b>
<b class="fc">&nbsp;    JCheckBoxMenuItem searchByKeyWord = new JCheckBoxMenuItem(&quot;General Search&quot;);</b>
<b class="fc">&nbsp;    JButton logOutButton = new JButton(&quot;LOGOUT&quot;);</b>
&nbsp;    //tips page button
<b class="fc">&nbsp;    JButton tipsButton = new JButton(&quot;TIPS&quot;);</b>
<b class="fc">&nbsp;    JButton accountSittings = new JButton(&quot;Account Settings&quot;);</b>
<b class="fc">&nbsp;    JToggleButton ChangeColor = new JToggleButton(&quot;Dark Mode&quot;);</b>
<b class="fc">&nbsp;    JButton virusButton = new JButton(&quot;Virus File Scan&quot;);</b>
<b class="fc">&nbsp;    JButton hashCheckButton = new JButton(&quot;Hash/ID Check&quot;);</b>
&nbsp;
<b class="fc">&nbsp;    JButton softwareListsButton = new JButton(&quot;OS Types&quot;);</b>
&nbsp;
&nbsp;    String allAccountData;
&nbsp;    static String hashID;
&nbsp;
&nbsp;
<b class="fc">&nbsp;    mainPageFrame() {</b>
<b class="fc">&nbsp;        setLayoutManager();</b>
<b class="fc">&nbsp;        setLocationAndSize();</b>
<b class="fc">&nbsp;        addComponentsToContainer();</b>
<b class="fc">&nbsp;        addActionEvent();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setLocationAndSize() {
&nbsp;
<b class="fc">&nbsp;        searchLabel.setBounds(13, 15, 100, 30);</b>
<b class="fc">&nbsp;        searchLabel.setForeground(Color.white);</b>
<b class="fc">&nbsp;        searchField.setBounds(12, 15, 300, 25);</b>
&nbsp;
<b class="fc">&nbsp;        searchButton.setBounds(115, 49, 100, 30);</b>
&nbsp;
<b class="fc">&nbsp;        searchByID.setBounds(105, 100, 150, 30);</b>
<b class="fc">&nbsp;        searchByID.setForeground(Color.white);</b>
<b class="fc">&nbsp;        searchByID.setBackground(InitialPage.color);</b>
&nbsp;
<b class="fc">&nbsp;        searchBySystem.setBounds(105, 130, 150, 30);</b>
<b class="fc">&nbsp;        searchBySystem.setForeground(Color.white);</b>
<b class="fc">&nbsp;        searchBySystem.setBackground(InitialPage.color);</b>
&nbsp;
<b class="fc">&nbsp;        searchByVersion.setBounds(105, 160, 150, 30);</b>
<b class="fc">&nbsp;        searchByVersion.setForeground(Color.white);</b>
<b class="fc">&nbsp;        searchByVersion.setBackground(InitialPage.color);</b>
&nbsp;
<b class="fc">&nbsp;        searchByKeyWord.setBounds(105, 190, 150, 30);</b>
<b class="fc">&nbsp;        searchByKeyWord.setForeground(Color.white);</b>
<b class="fc">&nbsp;        searchByKeyWord.setBackground(InitialPage.color);</b>
&nbsp;
&nbsp;
<b class="pc">&nbsp;        if (allAccountData != null) {</b>
<b class="nc">&nbsp;            logOutButton.setBounds(200, 400, 100, 30);</b>
&nbsp;        } else {
<b class="fc">&nbsp;            logOutButton.setBounds(125, 400, 100, 30);</b>
<b class="fc">&nbsp;            logOutButton.setText(&quot;Return&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;
<b class="fc">&nbsp;        accountSittings.setBounds(30, 400, 150, 30);</b>
<b class="fc">&nbsp;        tipsButton.setBounds(10, 49, 100, 30);</b>
<b class="fc">&nbsp;        virusButton.setBounds(100, 310, 150, 30);</b>
<b class="fc">&nbsp;        hashCheckButton.setBounds(100, 350, 150, 30);</b>
<b class="fc">&nbsp;        softwareListsButton.setBounds(100, 270, 150, 30);</b>
<b class="fc">&nbsp;        ChangeColor.setBounds(220, 49, 105, 30);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public void openMainPage(mainPageFrame mainFrame, boolean c) {
&nbsp;
<b class="fc">&nbsp;        mainFrame.setTitle(&quot;main page&quot;);</b>
<b class="fc">&nbsp;        mainFrame.setVisible(c);</b>
<b class="fc">&nbsp;        mainFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);</b>
<b class="fc">&nbsp;        mainFrame.setBounds(600, 150, 350, 500);</b>
<b class="fc">&nbsp;        mainFrame.setResizable(false);</b>
<b class="fc">&nbsp;        mainFrame.setIconImage(breachyLogo.getImage());</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public void addComponentsToContainer() {
&nbsp;
<b class="fc">&nbsp;        mainPageContainer.add(searchLabel);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchField);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchButton);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchByID);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchBySystem);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchByVersion);</b>
<b class="fc">&nbsp;        mainPageContainer.add(searchByKeyWord);</b>
<b class="fc">&nbsp;        mainPageContainer.add(logOutButton);</b>
&nbsp;
&nbsp;
<b class="pc">&nbsp;        if (allAccountData != null) {</b>
<b class="nc">&nbsp;            mainPageContainer.add(accountSittings);</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        mainPageContainer.add(tipsButton);</b>
<b class="fc">&nbsp;        mainPageContainer.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;        mainPageContainer.add(ChangeColor);</b>
<b class="fc">&nbsp;        mainPageContainer.add(virusButton);</b>
<b class="fc">&nbsp;        mainPageContainer.add(hashCheckButton);</b>
<b class="fc">&nbsp;        mainPageContainer.add(softwareListsButton);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public void addActionEvent() {
&nbsp;
<b class="fc">&nbsp;        searchButton.addActionListener(this);</b>
<b class="fc">&nbsp;        logOutButton.addActionListener(this);</b>
<b class="fc">&nbsp;        accountSittings.addActionListener(this);</b>
<b class="fc">&nbsp;        searchByID.addActionListener(this);</b>
<b class="fc">&nbsp;        searchBySystem.addActionListener(this);</b>
<b class="fc">&nbsp;        searchByVersion.addActionListener(this);</b>
<b class="fc">&nbsp;        searchByKeyWord.addActionListener(this);</b>
<b class="fc">&nbsp;        tipsButton.addActionListener(this);</b>
<b class="fc">&nbsp;        ChangeColor.addActionListener(this);</b>
<b class="fc">&nbsp;        virusButton.addActionListener(this);</b>
<b class="fc">&nbsp;        hashCheckButton.addActionListener(this);</b>
<b class="fc">&nbsp;        softwareListsButton.addActionListener(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setLayoutManager() {
<b class="fc">&nbsp;        mainPageContainer.setLayout(null);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void actionPerformed(ActionEvent e) {
&nbsp;
<b class="fc">&nbsp;        SearchTool searchForBreach = new SearchTool();</b>
&nbsp;
<b class="pc">&nbsp;        if (e.getSource() == searchButton) {</b>
<b class="nc">&nbsp;            if (searchField.getText().isEmpty()) {</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(null, &quot;Field is empty!&quot;);</b>
&nbsp;            } else {
&nbsp;                String searchID, searchSys, searchVersion, searchGen;
<b class="nc">&nbsp;                String theBreach = &quot;&quot;;</b>
&nbsp;                try {
<b class="nc">&nbsp;                    if (searchByID.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchID = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchByID(searchID);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (searchBySystem.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchSys = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchBySystem(searchSys);</b>
&nbsp;
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (searchByVersion.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchVersion = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchByVersion(searchVersion);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (searchByKeyWord.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchGen = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchByDescription(searchGen);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if ((!searchByID.isSelected()) &amp;&amp; (!searchBySystem.isSelected()) &amp;&amp; (!searchByVersion.isSelected()) &amp;&amp; (!searchByKeyWord.isSelected())) {</b>
<b class="nc">&nbsp;                        searchGen = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.search(searchGen);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (!theBreach.equalsIgnoreCase(&quot; &quot;)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;final result &quot; + theBreach);</b>
<b class="nc">&nbsp;                        JOptionPane.showMessageDialog(this, theBreach);</b>
&nbsp;                    }
&nbsp;
&nbsp;
<b class="nc">&nbsp;                    if (searchBySystem.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchSys = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchBySystem(searchSys);</b>
&nbsp;
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (searchByVersion.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchVersion = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchByVersion(searchVersion);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (searchByKeyWord.isSelected()) {</b>
&nbsp;
<b class="nc">&nbsp;                        searchGen = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.searchByDescription(searchGen);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if ((!searchByID.isSelected()) &amp;&amp; (!searchBySystem.isSelected()) &amp;&amp; (!searchByVersion.isSelected()) &amp;&amp; (!searchByKeyWord.isSelected())) {</b>
<b class="nc">&nbsp;                        searchGen = searchField.getText();</b>
<b class="nc">&nbsp;                        theBreach = searchForBreach.search(searchGen);</b>
&nbsp;
&nbsp;                    }
<b class="nc">&nbsp;                    if (!theBreach.equalsIgnoreCase(&quot; &quot;)) {</b>
<b class="nc">&nbsp;                        System.out.println(&quot;final result &quot; + theBreach);</b>
<b class="nc">&nbsp;                        JOptionPane.showMessageDialog(this, theBreach);</b>
&nbsp;                    }
&nbsp;
&nbsp;
<b class="nc">&nbsp;                } catch (Exception ex) {</b>
<b class="nc">&nbsp;                    JOptionPane.showMessageDialog(null, &quot;Wrong search syntax!&quot;);</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        }
<b class="pc">&nbsp;        if (e.getSource() == logOutButton) {</b>
&nbsp;
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this, &quot;Thank You For using Out Application&quot;);</b>
<b class="nc">&nbsp;            this.toBack();</b>
<b class="nc">&nbsp;            setVisible(false);</b>
<b class="nc">&nbsp;            InitialPage initFrame = new InitialPage();</b>
<b class="nc">&nbsp;            initFrame.openIntialPage(initFrame, true);</b>
&nbsp;
&nbsp;        }
<b class="pc">&nbsp;        if (e.getSource() == tipsButton) {</b>
<b class="nc">&nbsp;            this.toFront();</b>
<b class="nc">&nbsp;            setVisible(false);</b>
<b class="nc">&nbsp;            tipsPageFrame tipsPage = new tipsPageFrame();</b>
<b class="nc">&nbsp;            tipsPage.openTipsPage(tipsPage, true);</b>
&nbsp;
&nbsp;        }
<b class="pc">&nbsp;        if (e.getSource() == accountSittings) {</b>
&nbsp;
<b class="nc">&nbsp;            this.toFront();</b>
<b class="nc">&nbsp;            setVisible(false);</b>
&nbsp;
<b class="nc">&nbsp;            String[] allDataArr = allAccountData.split(&quot; : &quot;);</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; allDataArr.length; i++) {</b>
<b class="nc">&nbsp;                System.out.println(allDataArr[i]);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            accountSittings sittings = new accountSittings();</b>
<b class="nc">&nbsp;            sittings.setUsername(allDataArr[0]);</b>
<b class="nc">&nbsp;            sittings.setPassword(allDataArr[1]);</b>
<b class="nc">&nbsp;            sittings.setEmail(allDataArr[2]);</b>
<b class="nc">&nbsp;            sittings.setStatus(allDataArr[3]);</b>
&nbsp;
<b class="nc">&nbsp;            sittings.openSittingsPage(sittings, true);</b>
&nbsp;
&nbsp;        }
<b class="pc">&nbsp;        if (ChangeColor.isSelected()) {</b>
<b class="nc">&nbsp;            InitialPage.color = new Color(40, 40, 40);</b>
<b class="nc">&nbsp;            mainPageContainer.setBackground(InitialPage.color);</b>
<b class="nc">&nbsp;            searchByID.setBackground(InitialPage.color);</b>
<b class="nc">&nbsp;            searchBySystem.setBackground(InitialPage.color);</b>
<b class="nc">&nbsp;            searchByVersion.setBackground(InitialPage.color);</b>
<b class="nc">&nbsp;            searchByKeyWord.setBackground(InitialPage.color);</b>
<b class="nc">&nbsp;            ChangeColor.setText(&quot;Light Mode&quot;);</b>
&nbsp;        } else {
<b class="fc">&nbsp;            InitialPage.color = new Color(93, 93, 112);</b>
<b class="fc">&nbsp;            mainPageContainer.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;            searchByID.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;            searchBySystem.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;            searchByVersion.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;            searchByKeyWord.setBackground(InitialPage.color);</b>
<b class="fc">&nbsp;            ChangeColor.setText(&quot;Dark Mode&quot;);</b>
&nbsp;        }
&nbsp;
<b class="pc">&nbsp;        if (e.getSource() == virusButton) {</b>
&nbsp;            try {
<b class="nc">&nbsp;                VirusScan();</b>
<b class="nc">&nbsp;            } catch (IOException ex) {</b>
<b class="nc">&nbsp;                throw new RuntimeException(ex);</b>
<b class="nc">&nbsp;            } catch (InterruptedException | URISyntaxException ex) {</b>
<b class="nc">&nbsp;                throw new RuntimeException(ex);</b>
<b class="nc">&nbsp;            }</b>
&nbsp;
&nbsp;        }
<b class="pc">&nbsp;        if (e.getSource() == hashCheckButton) {</b>
<b class="nc">&nbsp;            VirusReport();</b>
&nbsp;        }
&nbsp;
<b class="pc">&nbsp;        if (e.getSource() == softwareListsButton) {</b>
<b class="nc">&nbsp;            this.toFront();</b>
<b class="nc">&nbsp;            setVisible(false);</b>
<b class="nc">&nbsp;            SoftwareListsFrame softPage = new SoftwareListsFrame();</b>
&nbsp;
&nbsp;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static void VirusScan() throws IOException, InterruptedException, URISyntaxException {
&nbsp;
<b class="fc">&nbsp;        JFileChooser fileChooser = new JFileChooser();</b>
<b class="fc">&nbsp;        fileChooser.setCurrentDirectory(new File(&quot;.&quot;)); //sets current directory</b>
&nbsp;
<b class="fc">&nbsp;        int r = fileChooser.showOpenDialog(null); //select file to open</b>
<b class="pc">&nbsp;        if (r == JFileChooser.APPROVE_OPTION) {</b>
<b class="nc">&nbsp;            file = new File(fileChooser.getSelectedFile().getAbsolutePath());</b>
<b class="pc">&nbsp;        } else if (r == JFileChooser.CANCEL_OPTION)</b>
&nbsp;            return;
<b class="nc">&nbsp;        HttpRequest request = HttpRequest.newBuilder()</b>
<b class="nc">&nbsp;                .uri(URI.create(API_Scan))</b>
<b class="nc">&nbsp;                .header(&quot;accept&quot;, &quot;text/plain&quot;)</b>
<b class="nc">&nbsp;                .header(&quot;content-type&quot;, &quot;application/x-www-form-urlencoded&quot;)</b>
<b class="nc">&nbsp;                .method(&quot;POST&quot;, HttpRequest.BodyPublishers.ofString(&quot;apikey=&quot; + API_Key + &quot;&amp;file=&quot; + file))</b>
<b class="nc">&nbsp;                .build();</b>
<b class="nc">&nbsp;        HttpResponse&lt;String&gt; response = HttpClient.newHttpClient().send(request, HttpResponse.BodyHandlers.ofString());</b>
<b class="nc">&nbsp;        if (response != null) {</b>
&nbsp;            //System.out.println(response.body());
<b class="nc">&nbsp;            ScanInfo sInfo = parseVirusScanResponse(response.body(), ScanInfo.class);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(null, sInfo);</b>
<b class="nc">&nbsp;            int resp = JOptionPane.showConfirmDialog(null, &quot;Do you want to open the website?&quot;, &quot;Open Website&quot;, JOptionPane.YES_NO_OPTION);</b>
<b class="nc">&nbsp;            if (resp == JOptionPane.YES_OPTION) {</b>
<b class="nc">&nbsp;                URI url = new URI(sInfo.getPermalink().replace(&quot;\&quot;&quot;, &quot;&quot;));</b>
<b class="nc">&nbsp;                Desktop desktop = Desktop.getDesktop();</b>
<b class="nc">&nbsp;                desktop.browse(url);</b>
&nbsp;            } else {
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public static ScanInfo parseVirusScanResponse(String responseString, Class&lt;?&gt; elementClass) {
<b class="nc">&nbsp;        ObjectMapper objectMapper = new ObjectMapper();</b>
&nbsp;        try {
<b class="nc">&nbsp;            JsonNode ScanInfoNode = objectMapper.readTree(responseString);</b>
<b class="nc">&nbsp;            ScanInfo sInfo = new ScanInfo();</b>
<b class="nc">&nbsp;            String verbose_msg = ScanInfoNode.get(&quot;verbose_msg&quot;).toString();</b>
<b class="nc">&nbsp;            String permalink = ScanInfoNode.get(&quot;permalink&quot;).toString();</b>
<b class="nc">&nbsp;            String scan_id = ScanInfoNode.get(&quot;scan_id&quot;).toString();</b>
&nbsp;
<b class="nc">&nbsp;            sInfo.setScan_id(scan_id);</b>
<b class="nc">&nbsp;            sInfo.setVerbose_msg(verbose_msg);</b>
<b class="nc">&nbsp;            sInfo.setPermalink(permalink);</b>
&nbsp;
<b class="nc">&nbsp;            return sInfo;</b>
<b class="nc">&nbsp;        } catch (JsonProcessingException e) {</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;            return null;</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(null, &quot;Error&quot;);</b>
<b class="nc">&nbsp;            System.out.println(&quot;Error&quot;);</b>
<b class="nc">&nbsp;            System.out.println(e);</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public static void VirusReport() {
<b class="fc">&nbsp;        URIBuilder uriBuilder = null;</b>
&nbsp;        try {
<b class="fc">&nbsp;            hashID = searchField.getText();</b>
<b class="fc">&nbsp;            uriBuilder = new URIBuilder(API_Report);</b>
<b class="fc">&nbsp;            uriBuilder.addParameter(&quot;apikey&quot;, API_Key);</b>
<b class="fc">&nbsp;            uriBuilder.addParameter(&quot;resource&quot;, hashID);</b>
<b class="fc">&nbsp;            uriBuilder.addParameter(&quot;allinfo&quot;, &quot;false&quot;);</b>
<b class="fc">&nbsp;            URI uri = uriBuilder.build();</b>
<b class="fc">&nbsp;            HttpResponse&lt;String&gt; response = httpAPI.sendGet(uri);</b>
<b class="pc">&nbsp;            if (response != null) {</b>
&nbsp;
<b class="nc">&nbsp;                VirusInfo vInfo = parseVirusResponse(response.body(), VirusInfo.class);</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(null, vInfo);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(null, &quot;Enter SCAN ID OR FILE HASH !&quot;);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public static VirusInfo parseVirusResponse(String responseString, Class&lt;?&gt; elementClass) {
<b class="nc">&nbsp;        ObjectMapper objectMapper = new ObjectMapper();</b>
&nbsp;        try {
<b class="nc">&nbsp;            JsonNode VirusInfoNode = objectMapper.readTree(responseString);</b>
<b class="nc">&nbsp;            VirusInfo vInfo = new VirusInfo();</b>
<b class="nc">&nbsp;            String detected = VirusInfoNode.get(&quot;scans&quot;).get(&quot;McAfee&quot;).get(&quot;detected&quot;).toString();</b>
<b class="nc">&nbsp;            String result = VirusInfoNode.get(&quot;scans&quot;).get(&quot;McAfee&quot;).get(&quot;result&quot;).toString();</b>
&nbsp;
<b class="nc">&nbsp;            vInfo.setDetected(detected);</b>
<b class="nc">&nbsp;            vInfo.setResult(result);</b>
&nbsp;
<b class="nc">&nbsp;            return vInfo;</b>
<b class="nc">&nbsp;        } catch (JsonProcessingException e) {</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-02-18 19:44</div>
</div>
</body>
</html>
